Segment Tree:

http://www.slideshare.net/iwiwi/ss-3578491
http://www.slideshare.net/sndtkrh/ss-47669151
