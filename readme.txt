Segment Tree:

http://www.slideshare.net/sndtkrh/ss-47669151
